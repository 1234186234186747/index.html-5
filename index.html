<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipkart Pro - Admin Edit Mode</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --fk-blue: #2874f0; --fk-orange: #fb641b; }
        .fk-blue-bg { background-color: var(--fk-blue); }
        .fk-orange-bg { background-color: var(--fk-orange); }
        .hidden { display: none !important; }
        .product-card { border-right: 1px solid #f0f0f0; border-bottom: 1px solid #f0f0f0; transition: 0.2s; }
        .product-card:active { background: #f9f9f9; }
    </style>
</head>
<body class="bg-gray-100 font-sans">

    <nav class="fk-blue-bg p-3 sticky top-0 z-[100] shadow-md text-white flex justify-between items-center">
        <div class="flex items-center" onclick="showStore()">
            <i class="fa-solid fa-bars mr-4"></i>
            <h1 class="text-lg font-bold italic">Flipkart</h1>
        </div>
        <button onclick="toggleAdmin()" class="border border-white/50 px-3 py-1 rounded text-[10px] font-bold">ADMIN PANEL</button>
    </nav>

    <div id="storePage">
        <div class="bg-white p-2 mb-2 shadow-sm"><img src="https://rukminim1.flixcart.com/fk-p-flap/1600/270/image/b0717a61f879654d.jpg" class="w-full rounded-sm"></div>
        <div id="productGrid" class="grid grid-cols-2 bg-white"></div>
    </div>

    <div id="detailPage" class="hidden fixed inset-0 bg-white z-[150] overflow-y-auto pb-20">
        <nav class="p-4 border-b flex items-center bg-white sticky top-0">
            <button onclick="showStore()" class="text-gray-700 mr-4 text-xl"><i class="fa-solid fa-arrow-left"></i></button>
            <h1 class="text-sm font-bold text-gray-600">Product Details</h1>
        </nav>
        <div class="p-4">
            <img id="detImg" src="" class="w-full h-64 object-contain mb-4">
            <h2 id="detName" class="text-md font-medium text-gray-800"></h2>
            <div class="flex items-center space-x-2 mt-2">
                <span id="detPrice" class="text-2xl font-bold text-gray-900"></span>
                <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/fa_62673a.png" class="h-4">
            </div>
        </div>
        <div class="fixed bottom-0 w-full flex h-14 border-t">
            <button class="flex-1 bg-white font-bold text-gray-800 uppercase text-sm">Cart</button>
            <button onclick="openCheckout()" class="flex-1 fk-orange-bg text-white font-bold uppercase text-sm">Buy Now</button>
        </div>
    </div>

    <div id="adminPage" class="hidden p-5 bg-white min-h-screen">
        <div class="flex justify-between items-center mb-6 border-b pb-2">
            <h2 class="text-xl font-bold text-blue-600">Product Manager</h2>
            <button onclick="showStore()" class="text-gray-400 text-2xl">&times;</button>
        </div>
        
        <div class="bg-gray-50 p-4 rounded-lg shadow-inner mb-8 space-y-3">
            <h3 id="formTitle" class="font-bold text-gray-700 text-sm uppercase">Add New Product</h3>
            <input type="password" id="lock" class="w-full border p-2 rounded text-sm" placeholder="Admin Lock (947228)">
            <input type="text" id="pName" class="w-full border p-2 rounded text-sm" placeholder="Product Name">
            <input type="number" id="pPrice" class="w-full border p-2 rounded text-sm" placeholder="Price (₹)">
            <input type="text" id="pImg" class="w-full border p-2 rounded text-sm" placeholder="Image URL">
            <input type="hidden" id="editIndex" value="-1">
            <div class="flex space-x-2">
                <button onclick="saveProduct()" id="saveBtn" class="flex-1 fk-blue-bg text-white py-3 rounded font-bold">SAVE PRODUCT</button>
                <button onclick="resetForm()" id="cancelBtn" class="hidden flex-1 bg-gray-400 text-white py-3 rounded font-bold">CANCEL</button>
            </div>
        </div>

        <h3 class="font-bold text-gray-400 text-[10px] mb-3 tracking-widest uppercase">Live Inventory</h3>
        <div id="adminList" class="space-y-2"></div>
    </div>

    <div id="checkoutModal" class="hidden fixed inset-0 bg-black/60 z-[200] flex items-end">
        <div class="bg-white w-full rounded-t-xl p-6">
            <h3 class="font-bold mb-4 border-b pb-2">Delivery Details</h3>
            <input type="text" id="custName" class="w-full border-b p-2 mb-4 outline-none" placeholder="Full Name">
            <div class="bg-blue-50 p-3 rounded mb-4 text-[10px] font-bold text-blue-700 uppercase italic">Target UPI: 8709615634-w350@ybl</div>
            <button onclick="triggerUPI()" class="w-full fk-orange-bg text-white py-3 rounded font-bold">PAY & CONFIRM</button>
            <button onclick="closeModal()" class="w-full text-gray-400 mt-2 text-sm">Close</button>
        </div>
    </div>

    <script>
        const MY_UPI = "8709615634-w350@ybl";
        let products = JSON.parse(localStorage.getItem('fk_pro_data')) || [
            {name: "iPhone 15 Pro Max", price: "129990", img: "https://m.media-amazon.com/images/I/81Sig6biNPL._SL1500_.jpg"}
        ];

        function renderAll() {
            // Render Store
            const grid = document.getElementById('productGrid');
            grid.innerHTML = products.map((p, i) => `
                <div onclick="showDetails(${i})" class="product-card p-4 flex flex-col justify-between h-64">
                    <img src="${p.img}" class="h-32 object-contain mx-auto mb-2">
                    <h3 class="text-xs text-gray-700 line-clamp-2">${p.name}</h3>
                    <div class="flex items-center space-x-1 mt-1">
                        <span class="text-sm font-bold">₹${Number(p.price).toLocaleString('en-IN')}</span>
                        <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/fa_62673a.png" class="h-3">
                    </div>
                </div>
            `).join('');

            // Render Admin List
            const list = document.getElementById('adminList');
            list.innerHTML = products.map((p, i) => `
                <div class="flex items-center justify-between border p-3 rounded bg-white shadow-sm">
                    <div class="flex items-center space-x-3 overflow-hidden">
                        <img src="${p.img}" class="h-10 w-10 object-contain">
                        <span class="text-xs font-medium truncate w-32">${p.name}</span>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editProduct(${i})" class="text-blue-600 bg-blue-50 px-3 py-1 rounded text-[10px] font-bold">EDIT</button>
                        <button onclick="deleteProduct(${i})" class="text-red-600 bg-red-50 px-3 py-1 rounded text-[10px] font-bold">DELETE</button>
                    </div>
                </div>
            `).join('');
            
            localStorage.setItem('fk_pro_data', JSON.stringify(products));
        }

        function saveProduct() {
            if(document.getElementById('lock').value !== "947228") { alert("Wrong Code!"); return; }
            const name = document.getElementById('pName').value;
            const price = document.getElementById('pPrice').value;
            const img = document.getElementById('pImg').value;
            const editIdx = parseInt(document.getElementById('editIndex').value);

            if(!name || !price || !img) { alert("Sari Details bhariye!"); return; }

            if(editIdx === -1) {
                products.push({name, price, img});
            } else {
                products[editIdx] = {name, price, img};
            }

            resetForm();
            renderAll();
            alert("Product Saved!");
        }

        function editProduct(i) {
            const p = products[i];
            document.getElementById('pName').value = p.name;
            document.getElementById('pPrice').value = p.price;
            document.getElementById('pImg').value = p.img;
            document.getElementById('editIndex').value = i;
            
            document.getElementById('formTitle').innerText = "Edit Product Mode";
            document.getElementById('saveBtn').innerText = "UPDATE PRODUCT";
            document.getElementById('cancelBtn').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function deleteProduct(i) {
            if(confirm("Delete karna chahte hain?")) {
                products.splice(i, 1);
                renderAll();
            }
        }

        function resetForm() {
            document.getElementById('pName').value = "";
            document.getElementById('pPrice').value = "";
            document.getElementById('pImg').value = "";
            document.getElementById('editIndex').value = "-1";
            document.getElementById('formTitle').innerText = "Add New Product";
            document.getElementById('saveBtn').innerText = "SAVE PRODUCT";
            document.getElementById('cancelBtn').classList.add('hidden');
        }

        function showDetails(i) {
            const p = products[i];
            window.selectedP = p;
            document.getElementById('detName').innerText = p.name;
            document.getElementById('detPrice').innerText = "₹" + Number(p.price).toLocaleString('en-IN');
            document.getElementById('detImg').src = p.img;
            document.getElementById('storePage').classList.add('hidden');
            document.getElementById('detailPage').classList.remove('hidden');
            window.scrollTo(0,0);
        }

        function showStore() { 
            document.getElementById('storePage').classList.remove('hidden'); 
            document.getElementById('detailPage').classList.add('hidden'); 
            document.getElementById('adminPage').classList.add('hidden'); 
        }

        function toggleAdmin() { 
            document.getElementById('adminPage').classList.toggle('hidden'); 
            document.getElementById('storePage').classList.toggle('hidden'); 
        }

        function openCheckout() { document.getElementById('checkoutModal').classList.remove('hidden'); }
        function closeModal() { document.getElementById('checkoutModal').classList.add('hidden'); }

        function triggerUPI() {
            if(!document.getElementById('custName').value) { alert("Name bhariye!"); return; }
            window.location.href = `upi://pay?pa=${MY_UPI}&pn=Flipkart&am=${window.selectedP.price}&cu=INR`;
        }

        renderAll();
    </script>
</body>
</html>
